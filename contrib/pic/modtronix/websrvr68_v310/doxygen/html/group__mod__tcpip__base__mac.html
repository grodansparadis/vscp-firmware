<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SBC68EC Web Server: Ethernet</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Ethernet<br>
<small>
[<a class="el" href="group__mod__tcpip__base.html">TCP/IP Base Protocols</a>]</small>
</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Files</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mac_8h.html">mac.h</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">MAC Module for Modtronix TCP/IP Stack. <br></td></tr>

<p>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<h2><a class="anchor" name="mod_tcpip_base_mac_description">
Description</a></h2>
The MAC module contains the driver software for the RTL8019AS NIC chip. It provides functions for reading and writing data from and to it. The RTL8019AS is a NE2000 compatible NIC, that implements both the Ethernet physical (PHY) and MAC layers. If a different NIC is to be used, users will need to modify or create a new "mac.c" file to implement access. As long as services provided by "mac.c" are not changed, all other modules will remain unchanged.<p>
The stack utilizes the on-chip SRAM available on the NIC as a holding buffer, until a higher level module reads it. It also performs the necessary IP checksum calculations in the NIC’s SRAM buffer. In addition to the receive FIFO buffer managed by the NIC itself, the MAC layer manages its own transmit queue. Using this queue, the caller can transmit a message and request the MAC to reserve it so that the same message can be retransmitted, if required. The user can specify sizes for the transmit buffer, transmit queue and receive queue using ‘C’ defines - see <a class="el" href="projdefs_8h.html" title="Project configuration.">projdefs.h</a> for details.<h2><a class="anchor" name="mod_tcpip_base_mac_buffers">
RTL8019AS Receive and Transmit buffers</a></h2>
The NIC has 8kbytes of RAM, devided into 256byte pages. At initialization, a group of these pages will be configured to be the RX buffer. The remaining pages are used for user RAM and for the TX buffer. <br>
<b>Receive</b><br>
 During reception, the NIC will transfer the received packet via Local DMA to the RX buffer. The user has to check if the RX buffer contains any packets, and if so, remove them via Remote DMA access (MACGetRxbuf and MACGetArray functions). One of two RTL8019AS commands can be used to retrieve received packets from the RX buffer: <ul>
<li>Remote read command. The user has to set the "Remote Start Registers" and the lenght. The User also has to remove the packet from the RX buffer once read. </li>
<li>Send Packet command. The Remote SMA registers are automatically configured to read the next packet from the RX buffer. After it has been read, it ia automatically removed too.</li>
</ul>
<br>
<b>Transmit</b><br>
 Transmission is done via writing the TX packet to a location in RAM via Remote DMA, and than setting registers in the NIC to start transmission.<h2><a class="anchor" name="mod_tcpip_base_mac_ring">
MAC Receive Ring Buffer</a></h2>
The MAC makes all received packets available to the user via the MACGetRxbuf() and <a class="el" href="mac_8h.html#89d13e85195c0d00f308194305845016">MACGetArray()</a> functions. These functions will read the given amount of bytes from the current RX Buffer. The current receive buffer is the one we are currently reading from. The <a class="el" href="mac_8h.html#6f0a2614cde1253e6edcc78d1a069b79">MACDiscardRx()</a> function will free the current receive buffer.<h2><a class="anchor" name="mod_tcpip_user_mac_conf">
Configuration</a></h2>
For details on configuring this module, see <a class="el" href="mac_8h.html#mac_conf">Configuration</a> section of <a class="el" href="mac_8h.html" title="MAC Module for Modtronix TCP/IP Stack.">mac.h</a> file. </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri May 14 08:54:23 2010 for SBC68EC Web Server by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
