<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SBC68EC Web Server: File System FSFRAM</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>File System FSFRAM<br>
<small>
[<a class="el" href="group__mod__sys.html">System Modules</a>]</small>
</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Files</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsfram_8h.html">fsfram.h</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">FSFRAM Module for Modtronix TCP/IP Stack. <br></td></tr>

<p>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<h2><a class="anchor" name="mod_sys_mxfs_format">
Format</a></h2>
The Modtronix HTTP Server can use a simple file system (the Modtronix FRAM File System, or "FSFRAM") to store Web pages in the FRAM. This documentation is for version 1 of the FSFRAM. The FSFRAM image is stored in an external serial FRAM. FSFRAM follows a special format to store multiple files in the given storage media, which is summarized in Figure 1.<p>
NOTE: This file system is essential the same as the FSEE file system, with changes in implementation having been made to accomodate FRAM IO.<p>
<br>
 <table class="compactTable" cellpadding="2" cellspacing="0" border="1">
<tr>
<td>Reserved Block&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </td></tr>
<tr>
<td>FSYS Header </td></tr>
<tr>
<td>FAT Entry 1 </td></tr>
<tr>
<td>............. </td></tr>
<tr>
<td>FAT Entry n </td></tr>
<tr>
<td>File 1 </td></tr>
<tr>
<td>............. </td></tr>
<tr>
<td>File n </td></tr>
</table>
<em>Figure 1</em> - File System Image Format<p>
The length of "Reserved Block" is defined by FSFRAM_RESERVE_BLOCK. The reserved block can be used by the main application to store simple configuration values. FSFRAM storage begins with the "FSYS Header", which contains information about the File System type, length and other info. The format of the "FSYS Header" is shown in Figure 2.<p>
<br>
 <table class="compactTable" cellpadding="2" cellspacing="0" border="1">
<tr>
<td>FSYS Header Length <em>(8 bits)</em> </td><td>File System Identifier <em>(8 bits)</em> </td><td>File System Version <em>(8 bits)</em> </td><td>FAT Entries <em>(16 bits)</em> </td></tr>
</table>
<em>Figure 2</em> - FSFRAM "FSYS Header" Format c<ul>
<li>The "File System Identifier" of the FSFRAM (Modtronix EEPROM File System) with a maximum File System size of 16 Mbytes and file size of 64 Kbytes is 0x01. This is the default type for the FSFRAM File System.</li></ul>
<p>
<ul>
<li>The "File System Identifier" of the FSFRAM (Modtronix EEPROM File System) with a maximum File System size of 16 Mbytes and file size of 16 Mbytes is 0x02. This is also know as the FSFRAM16M File System.</li></ul>
<p>
Following the "FSYS Header" is one or more "FAT Entries" (File Allocation Table), followed by the file data of each file. The "FAT entries" are always in alphabetic order, and all file names are in capitals. The "FAT entry" describes the file name, location and it's attributes. The format of the "FAT Entry" is shown in Figure 3.<p>
<br>
 <table class="compactTable" cellpadding="2" cellspacing="0" border="1">
<tr>
<td>Attributes <em>(8 bits)</em> </td><td>File Name <em>(8-byte + 3-byte format)</em> </td><td>Address <em>(24 bits)</em> </td><td>File Length <em>(16 or 24 bits)</em> </td></tr>
</table>
<em>Figure 3</em> - FSFRAM FAT Entry Format<p>
The "Attributes" indicates whether the file is a normal file or a read only file.<p>
Each FAT entry contains a 24-bit address value. This implies a maximum FSFRAM image size of 16 Mbytes.<p>
FSFRAM uses "short" file names of the "8 + 3" format (8 bytes for the actual file name and 3 bytes for the extension, or NNNNNNNN.EEE). The 24-bit address gives the start of the first file data block. All file names are stored in upper case to make file name comparisons easier. All FAT entries are in alphabetical order to make finding a file faster.<p>
The address in each FAT entry points in turn to a data block that contains the actual file data. The data block format is shown in Figure 3.<p>
<br>
<br>
 <table class="compactTable" cellpadding="2" cellspacing="0" border="1">
<tr>
<td>Data <em>(variable length)</em> </td></tr>
</table>
<em>Figure 3</em> - FSFRAM Data Block Format </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri May 14 08:54:23 2010 for SBC68EC Web Server by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
